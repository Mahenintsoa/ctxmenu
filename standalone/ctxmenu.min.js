!function(){"use strict";function e(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var r=arguments[t],s=0,a=r.length;s<a;s++,o++)i[o]=r[s];return i}var t={".ctxmenu":{position:"fixed",maxHeight:"100vh",border:"1px solid #999",padding:"2px 0",boxShadow:"3px 3px 3px #aaa",background:"#fff",margin:"0",fontSize:"15px",fontFamily:"Verdana, sans-serif",zIndex:"9999",overflowY:"auto"},".ctxmenu li":{margin:"1px 0",display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none"},".ctxmenu li span":{display:"block",padding:"2px 20px",cursor:"default"},".ctxmenu li a":{color:"inherit",textDecoration:"none"},".ctxmenu li.icon":{paddingLeft:"15px"},".ctxmenu img.icon":{position:"absolute",width:"18px",left:"10px",top:"2px"},".ctxmenu li.disabled":{color:"#ccc"},".ctxmenu li.divider":{borderBottom:"1px solid #aaa",margin:"5px 0"},".ctxmenu li.interactive:hover":{background:"rgba(0,0,0,0.1)"},".ctxmenu li.submenu::after":{content:"''",position:"absolute",display:"block",top:"0",bottom:"0",right:"0.4em",margin:"auto",borderRight:"1px solid #000",borderTop:"1px solid #000",transform:"rotate(45deg)",width:"0.3rem",height:"0.3rem",marginRight:"0.1rem"},".ctxmenu li.submenu.disabled::after":{borderColor:"#ccc"}},n=function(){function n(){var e=this;this.cache={},this.hdir="r",this.vdir="d",this.preventCloseOnScroll=!1,window.addEventListener("click",(function(t){var n=t.target instanceof Element&&t.target.parentElement;n&&"interactive"===n.className||e.hide()})),window.addEventListener("resize",(function(){return e.hide()}));var t=0;window.addEventListener("wheel",(function(){clearTimeout(t),t=setTimeout((function(){e.preventCloseOnScroll?e.preventCloseOnScroll=!1:e.hide()}))}),{passive:!0}),n.addStylesToDom()}return n.getInstance=function(){n.instance||(n.instance=new n);var e=n.instance;return{attach:e.attach.bind(e),delete:e.delete.bind(e),hide:e.hide.bind(e),show:e.show.bind(e),update:e.update.bind(e)}},n.prototype.attach=function(t,n,i){var o=this;void 0===i&&(i=function(e){return e});var r=document.querySelector(t);if(void 0===this.cache[t])if(r){var s=function(t){var r=i(e(n),t);o.show(r,t)};this.cache[t]={ctxMenu:n,handler:s,beforeRender:i},r.addEventListener("contextmenu",s)}else console.error("target element "+t+" not found");else console.error("target element "+t+" already has a context menu assigned. Use ContextMenu.update() intstead.")},n.prototype.update=function(e,t,n){var i=this.cache[e],o=document.querySelector(e);i&&(null==o||o.removeEventListener("contextmenu",i.handler)),delete this.cache[e],this.attach(e,t||(null==i?void 0:i.ctxMenu)||[],n||(null==i?void 0:i.beforeRender))},n.prototype.delete=function(e){var t=this.cache[e];if(t){var n=document.querySelector(e);n?(n.removeEventListener("contextmenu",t.handler),delete this.cache[e]):console.error("target element "+e+" does not exist (anymore)")}else console.error("no context menu for target element "+e+" found")},n.prototype.show=function(t,n){var i=this;n instanceof MouseEvent&&n.stopImmediatePropagation(),this.hide(),this.menu=this.generateDOM(e(t),n),document.body.appendChild(this.menu),this.menu.addEventListener("wheel",(function(){return i.preventCloseOnScroll=!0}),{passive:!0}),n instanceof MouseEvent&&n.preventDefault()},n.prototype.hide=function(e){var t;void 0===e&&(e=this.menu),this.hdir="r",this.vdir="d",e&&(e===this.menu&&delete this.menu,null===(t=e.parentElement)||void 0===t||t.removeChild(e))},n.prototype.debounce=function(e,t){var n;e.addEventListener("mouseenter",(function(e){n=setTimeout((function(){return t(e)}),150)})),e.addEventListener("mouseleave",(function(){return clearTimeout(n)}))},n.prototype.generateDOM=function(e,t){var i=this,o=document.createElement("ul");0===e.length&&(o.style.display="none"),e.forEach((function(e){var t=document.createElement("li");if(i.debounce(t,(function(){var e,n=null===(e=t.parentElement)||void 0===e?void 0:e.querySelector("ul");n&&n.parentElement!==t&&i.hide(n)})),n.itemIsDivider(e))t.className="divider";else{var r=n.getProp(e.html),s="<span>"+n.getProp(e.text)+"</span>",a=n.getProp(e.element);if(a?t.append(a):t.innerHTML=r||s,t.title=n.getProp(e.tooltip)||"",e.style&&t.setAttribute("style",n.getProp(e.style)),n.itemIsInteractive(e))if(n.getProp(e.disabled))t.classList.add("disabled"),n.itemIsSubMenu(e)&&t.classList.add("submenu");else if(t.classList.add("interactive"),n.itemIsAction(e))t.addEventListener("click",(function(t){e.action(t),i.hide()}));else if(n.itemIsAnchor(e)){var d=document.createElement("a");a?d.append(a):d.innerHTML=r||s,d.onclick=function(){return i.hide()},d.href=n.getProp(e.href),e.hasOwnProperty("download")&&(d.download=n.getProp(e.download)),e.hasOwnProperty("target")&&(d.target=n.getProp(e.target)),t.childNodes.forEach((function(e){return e.remove()})),t.append(d)}else n.itemIsSubMenu(e)&&(0===n.getProp(e.subMenu).length?t.classList.add("disabled"):(t.classList.add("submenu"),i.debounce(t,(function(o){t.querySelector("ul")||i.openSubMenu(o,n.getProp(e.subMenu),t)}))));else t.setAttribute("style","font-weight: bold; margin-left: -5px;"+t.getAttribute("style"));n.getProp(e.icon)&&(t.classList.add("icon"),t.innerHTML+='<img class="icon" src="'+n.getProp(e.icon)+'" />')}o.appendChild(t)})),o.className="ctxmenu";var r=n.getBounding(o),s={x:0,y:0};if(t instanceof Element){var a=t.getBoundingClientRect();s={x:"r"===this.hdir?a.left+a.width:a.left-r.width,y:a.top},t.className.includes("submenu")&&(s.y+="d"===this.vdir?4:-12);var d=this.getPosition(r,s);s.x!==d.x&&(this.hdir="r"===this.hdir?"l":"r",s.x="r"===this.hdir?a.left+a.width:a.left-r.width),s.y!==d.y&&(this.vdir="u"===this.vdir?"d":"u",s.y=d.y),s=this.getPosition(r,s,!1)}else s=this.getPosition(r,{x:t.clientX,y:t.clientY});return o.style.left=s.x+"px",o.style.top=s.y+"px",o.addEventListener("contextmenu",(function(e){e.stopPropagation(),e.preventDefault()})),o.addEventListener("click",(function(e){var t=e.target instanceof Element&&e.target.parentElement;t&&"interactive"!==t.className&&e.stopPropagation()})),o},n.prototype.openSubMenu=function(e,t,n){var i,o=null===(i=n.parentElement)||void 0===i?void 0:i.querySelector("li > ul");o&&o.parentElement!==n&&this.hide(o),n.appendChild(this.generateDOM(t,n))},n.getBounding=function(e){var t=e.cloneNode(!0);t.style.visibility="hidden",document.body.appendChild(t);var n=t.getBoundingClientRect();return document.body.removeChild(t),n},n.prototype.getPosition=function(e,t,n){void 0===n&&(n=!0);var i=window.innerWidth,o=window.innerHeight,r=""!==document.body.style.transform,s=r?window.scrollX:0,a=r?window.scrollY:0,d=r?i+window.scrollX:i,c=r?o+window.scrollY:o;return r&&n&&(t.x+=window.scrollX,t.y+=window.scrollY),{x:"r"===this.hdir?t.x+e.width>d?d-e.width:t.x:t.x<s?s:t.x,y:"d"===this.vdir?t.y+e.height>c?c-e.height:t.y:t.y<a?a:t.y}},n.getProp=function(e){return"function"==typeof e?e():e},n.itemIsInteractive=function(e){return this.itemIsAction(e)||this.itemIsAnchor(e)||this.itemIsSubMenu(e)||this.itemIsCustom(e)},n.itemIsAction=function(e){return e.hasOwnProperty("action")},n.itemIsAnchor=function(e){return e.hasOwnProperty("href")},n.itemIsDivider=function(e){return e.hasOwnProperty("isDivider")},n.itemIsSubMenu=function(e){return e.hasOwnProperty("subMenu")},n.itemIsCustom=function(e){return e.hasOwnProperty("html")||e.hasOwnProperty("element")},n.addStylesToDom=function(){var e=function(){var n=Object.entries(t).map((function(e){return e[0]+" { "+Object.assign(document.createElement("p").style,e[1]).cssText+" }"})),i=document.head.insertBefore(document.createElement("style"),document.head.childNodes[0]);n.forEach((function(e){var t;return null===(t=i.sheet)||void 0===t?void 0:t.insertRule(e)})),e=function(){}};"loading"!==document.readyState?e():document.addEventListener("readystatechange",(function(){"loading"!==document.readyState&&e()}))},n}().getInstance();
/*! ctxMenu v1.4.2 | (c) Nikolaj Kappler | https://github.com/nkappler/ctxmenu/blob/master/LICENSE !*/window.ctxmenu=n}();
