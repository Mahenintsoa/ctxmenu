"use strict";function e(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,d=o.length;a<d;a++,r++)i[r]=o[a];return i}function t(e){return"function"==typeof e?e():e}function n(e){return i(e)||r(e)||o(e)||function(e){return e.hasOwnProperty("html")||e.hasOwnProperty("element")}(e)}function i(e){return e.hasOwnProperty("action")}function r(e){return e.hasOwnProperty("href")}function o(e){return e.hasOwnProperty("subMenu")}function a(e,t){var n;e.addEventListener("mouseenter",(function(e){n=setTimeout((function(){return t(e)}),150)})),e.addEventListener("mouseleave",(function(){return clearTimeout(n)}))}function d(e){return t(e.disabled)||o(e)&&0===e.subMenu.length}function c(e){var a=document.createElement("li");if(function(e){return e.hasOwnProperty("isDivider")}(e))return a.className="divider",a;if(function(e,n){var i=t(e.html),r="<span>"+t(e.text)+"</span>",o=t(e.element);o?n.append(o):n.innerHTML=i||r,n.title=t(e.tooltip)||"",e.style&&n.setAttribute("style",t(e.style));e.icon&&(n.classList.add("icon"),n.innerHTML+='<img class="icon" src="'+t(e.icon)+'" />')}(e,a),!n(e))return a.classList.add("heading"),a;if(d(e))return a.classList.add("disabled"),o(e)&&a.classList.add("submenu"),a;if(a.classList.add("interactive"),r(e)){var c=document.createElement("a");return c.append.apply(c,Array.from(a.childNodes)),c.href=t(e.href),e.hasOwnProperty("download")&&(c.download=t(e.download)),e.hasOwnProperty("target")&&(c.target=t(e.target)),a.append(c),a}return i(e)?(a.addEventListener("click",e.action),a):(a.classList.add("submenu"),a)}Object.defineProperty(exports,"__esModule",{value:!0});var u="r",s="d";function l(e,t){var n=function(e){var t=e.cloneNode(!0);t.style.visibility="hidden",document.body.appendChild(t);var n=p(t);return document.body.removeChild(t),n}(e);n.width=Math.trunc(n.width)+1,e.style.width=n.width+"px",n.height=Math.trunc(n.height)+1,e.style.height=n.height+"px";var i={x:0,y:0};if(t instanceof Element){var r=p(t),o=r.x,a=r.width,d=r.y;i={x:"r"===u?o+a:o-n.width,y:d},t.className.includes("submenu")&&(i.y+="d"===s?4:-12);var c=h(n,i);i.x!==c.x&&(u="r"===u?"l":"r",i.x="r"===u?o+a:o-n.width),i.y!==c.y&&(s="u"===s?"d":"u",i.y=c.y),i=h(n,i)}else{var l=f(),m=document.body.getBoundingClientRect();i=h(n,{x:(t.clientX-m.x)/l.x,y:(t.clientY-m.y)/l.y})}e.style.left=i.x+"px",e.style.top=i.y+"px"}function h(e,t){var n=window.visualViewport,i=n.width,r=n.height,o=n.pageLeft,a=n.pageTop,d=document.body.getBoundingClientRect(),c=d.left,l=d.top,h=f(),p=(o-c)/h.x,m=(a-l)/h.y,v=(i-c)/h.x,y=(r-l)/h.y;return{x:"r"===u?t.x+e.width>v?v-e.width:t.x:t.x<p?p:t.x,y:"d"===s?t.y+e.height>y?y-e.height:t.y:t.y<m?m:t.y}}function p(e){var t=e.offsetLeft,n=e.offsetTop,i=e.offsetHeight,r=e.offsetWidth;if(e.offsetParent instanceof HTMLElement){var o=p(e.offsetParent);return{x:t+o.x,y:n+o.y,width:r,height:i}}return{x:t,y:n,width:r,height:i}}function f(){var e=document.body.getBoundingClientRect(),t=window.visualViewport;return{x:e.width/t.width,y:e.height/t.height}}var m=function(){function i(){var e=this;this.cache={},this.preventCloseOnScroll=!1,window.addEventListener("click",(function(t){var n=t.target instanceof Element&&t.target.parentElement;n&&"interactive"===n.className||e.hide()})),window.addEventListener("resize",(function(){return e.hide()}));var t=0;window.addEventListener("wheel",(function(){clearTimeout(t),t=setTimeout((function(){e.preventCloseOnScroll?e.preventCloseOnScroll=!1:e.hide()}))}),{passive:!0}),window.addEventListener("keydown",(function(t){"Escape"===t.key&&e.hide()})),i.addStylesToDom()}return i.getInstance=function(){i.instance||(i.instance=new i);var e=i.instance;return{attach:e.attach.bind(e),delete:e.delete.bind(e),hide:e.hide.bind(e),show:e.show.bind(e),update:e.update.bind(e)}},i.prototype.attach=function(t,n,i){var r=this;void 0===i&&(i=function(e){return e});var o=document.querySelector(t);if(void 0===this.cache[t])if(o){var a=function(t){var o=i(e(n),t);r.show(o,t)};this.cache[t]={ctxMenu:n,handler:a,beforeRender:i},o.addEventListener("contextmenu",a)}else console.error("target element "+t+" not found");else console.error("target element "+t+" already has a context menu assigned. Use ContextMenu.update() intstead.")},i.prototype.update=function(e,t,n){var i=this.cache[e],r=document.querySelector(e);i&&(null==r||r.removeEventListener("contextmenu",i.handler)),delete this.cache[e],this.attach(e,t||(null==i?void 0:i.ctxMenu)||[],n||(null==i?void 0:i.beforeRender))},i.prototype.delete=function(e){var t=this.cache[e];if(t){var n=document.querySelector(e);n?(n.removeEventListener("contextmenu",t.handler),delete this.cache[e]):console.error("target element "+e+" does not exist (anymore)")}else console.error("no context menu for target element "+e+" found")},i.prototype.show=function(t,n){var i=this;n instanceof MouseEvent&&n.stopImmediatePropagation(),this.hide(),this.menu=this.generateDOM(e(t),n),document.body.appendChild(this.menu),this.menu.addEventListener("wheel",(function(){return i.preventCloseOnScroll=!0}),{passive:!0}),n instanceof MouseEvent&&n.preventDefault()},i.prototype.hide=function(e){var t;void 0===e&&(e=this.menu),u="r",s="d",e&&(e===this.menu&&delete this.menu,null===(t=e.parentElement)||void 0===t||t.removeChild(e))},i.prototype.generateDOM=function(e,i){var r=this,u=document.createElement("ul");return 0===e.length&&(u.style.display="none"),e.forEach((function(e){var i=c(e);a(i,(function(){var e,t=null===(e=i.parentElement)||void 0===e?void 0:e.querySelector("ul");t&&t.parentElement!==i&&r.hide(t)})),n(e)&&!d(e)&&(o(e)?a(i,(function(n){i.querySelector("ul")||r.openSubMenu(n,t(e.subMenu),i)})):i.addEventListener("click",(function(){return r.hide()}))),u.appendChild(i)})),u.className="ctxmenu",l(u,i),u.addEventListener("contextmenu",(function(e){e.stopPropagation(),e.preventDefault()})),u.addEventListener("click",(function(e){var t=e.target instanceof Element&&e.target.parentElement;t&&"interactive"!==t.className&&e.stopPropagation()})),u},i.prototype.openSubMenu=function(e,t,n){var i,r=null===(i=n.parentElement)||void 0===i?void 0:i.querySelector("li > ul");r&&r.parentElement!==n&&this.hide(r),n.appendChild(this.generateDOM(t,n))},i.addStylesToDom=function(){var e=function(){if("loading"===document.readyState)return document.addEventListener("readystatechange",e);var t=document.createElement("style");t.innerHTML='html{min-height:100%}.ctxmenu{position:fixed;max-height:100vh;border:1px solid #999;padding:2px 0;box-shadow:#aaa 3px 3px 3px;background:#fff;margin:0;z-index:9999;overflow-y:auto;font:15px Verdana, sans-serif}.ctxmenu li{margin:1px 0;display:block;position:relative;user-select:none}.ctxmenu li.heading{font-weight:bold;margin-left:-5px}.ctxmenu li span{display:block;padding:2px 20px;cursor:default}.ctxmenu li a{color:inherit;text-decoration:none}.ctxmenu li.icon{padding-left:15px}.ctxmenu img.icon{position:absolute;width:18px;left:10px;top:2px}.ctxmenu li.disabled{color:#ccc}.ctxmenu li.divider{border-bottom:1px solid #aaa;margin:5px 0}.ctxmenu li.interactive:hover{background:rgba(0, 0, 0, .1)}.ctxmenu li.submenu::after{content:"";position:absolute;display:block;top:0;bottom:0;right:.4em;margin:auto .1rem auto auto;border-right:1px solid #000;border-top:1px solid #000;transform:rotate(45deg);width:.3rem;height:.3rem}.ctxmenu li.submenu.disabled::after{border-color:#ccc}',document.head.insertBefore(t,document.head.childNodes[0]),e=function(){}};e()},i}().getInstance();
/*! ctxMenu v1.4.5 | (c) Nikolaj Kappler | https://github.com/nkappler/ctxmenu/blob/master/LICENSE !*/exports.ctxmenu=m;
