"use strict";function e(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var r=arguments[t],a=0,d=r.length;a<d;a++,o++)i[o]=r[a];return i}Object.defineProperty(exports,"__esModule",{value:!0});function t(e){return"function"==typeof e?e():e}function n(e){return e.hasOwnProperty("action")}function i(e){return e.hasOwnProperty("href")}function o(e){return e.hasOwnProperty("subMenu")}
/*! ctxMenu v1.4.2 | (c) Nikolaj Kappler | https://github.com/nkappler/ctxmenu/blob/master/LICENSE !*/
var r=function(){function r(){var e=this;this.cache={},this.hdir="r",this.vdir="d",this.preventCloseOnScroll=!1,window.addEventListener("click",(function(t){var n=t.target instanceof Element&&t.target.parentElement;n&&"interactive"===n.className||e.hide()})),window.addEventListener("resize",(function(){return e.hide()}));var t=0;window.addEventListener("wheel",(function(){clearTimeout(t),t=setTimeout((function(){e.preventCloseOnScroll?e.preventCloseOnScroll=!1:e.hide()}))}),{passive:!0}),r.addStylesToDom()}return r.getInstance=function(){r.instance||(r.instance=new r);var e=r.instance;return{attach:e.attach.bind(e),delete:e.delete.bind(e),hide:e.hide.bind(e),show:e.show.bind(e),update:e.update.bind(e)}},r.prototype.attach=function(t,n,i){var o=this;void 0===i&&(i=function(e){return e});var r=document.querySelector(t);if(void 0===this.cache[t])if(r){var a=function(t){var r=i(e(n),t);o.show(r,t)};this.cache[t]={ctxMenu:n,handler:a,beforeRender:i},r.addEventListener("contextmenu",a)}else console.error("target element "+t+" not found");else console.error("target element "+t+" already has a context menu assigned. Use ContextMenu.update() intstead.")},r.prototype.update=function(e,t,n){var i=this.cache[e],o=document.querySelector(e);i&&(null==o||o.removeEventListener("contextmenu",i.handler)),delete this.cache[e],this.attach(e,t||(null==i?void 0:i.ctxMenu)||[],n||(null==i?void 0:i.beforeRender))},r.prototype.delete=function(e){var t=this.cache[e];if(t){var n=document.querySelector(e);n?(n.removeEventListener("contextmenu",t.handler),delete this.cache[e]):console.error("target element "+e+" does not exist (anymore)")}else console.error("no context menu for target element "+e+" found")},r.prototype.show=function(t,n){var i=this;n instanceof MouseEvent&&n.stopImmediatePropagation(),this.hide(),this.menu=this.generateDOM(e(t),n),document.body.appendChild(this.menu),this.menu.addEventListener("wheel",(function(){return i.preventCloseOnScroll=!0}),{passive:!0}),n instanceof MouseEvent&&n.preventDefault()},r.prototype.hide=function(e){var t;void 0===e&&(e=this.menu),this.hdir="r",this.vdir="d",e&&(e===this.menu&&delete this.menu,null===(t=e.parentElement)||void 0===t||t.removeChild(e))},r.prototype.debounce=function(e,t){var n;e.addEventListener("mouseenter",(function(e){n=setTimeout((function(){return t(e)}),150)})),e.addEventListener("mouseleave",(function(){return clearTimeout(n)}))},r.prototype.generateDOM=function(e,a){var d=this,s=document.createElement("ul");0===e.length&&(s.style.display="none"),e.forEach((function(e){var r=document.createElement("li");if(d.debounce(r,(function(){var e,t=null===(e=r.parentElement)||void 0===e?void 0:e.querySelector("ul");t&&t.parentElement!==r&&d.hide(t)})),function(e){return e.hasOwnProperty("isDivider")}(e))r.className="divider";else{var a=t(e.html),l="<span>"+t(e.text)+"</span>",c=t(e.element);if(c?r.append(c):r.innerHTML=a||l,r.title=t(e.tooltip)||"",e.style&&r.setAttribute("style",t(e.style)),function(e){return n(e)||i(e)||o(e)||function(e){return e.hasOwnProperty("html")||e.hasOwnProperty("element")}(e)}(e))if(t(e.disabled))r.classList.add("disabled"),o(e)&&r.classList.add("submenu");else if(r.classList.add("interactive"),n(e))r.addEventListener("click",(function(t){e.action(t),d.hide()}));else if(i(e)){var u=document.createElement("a");c?u.append(c):u.innerHTML=a||l,u.onclick=function(){return d.hide()},u.href=t(e.href),e.hasOwnProperty("download")&&(u.download=t(e.download)),e.hasOwnProperty("target")&&(u.target=t(e.target)),r.childNodes.forEach((function(e){return e.remove()})),r.append(u)}else o(e)&&(0===t(e.subMenu).length?r.classList.add("disabled"):(r.classList.add("submenu"),d.debounce(r,(function(n){r.querySelector("ul")||d.openSubMenu(n,t(e.subMenu),r)}))));else r.setAttribute("style","font-weight: bold; margin-left: -5px;"+r.getAttribute("style"));t(e.icon)&&(r.classList.add("icon"),r.innerHTML+='<img class="icon" src="'+t(e.icon)+'" />')}s.appendChild(r)})),s.className="ctxmenu";var l=r.getBounding(s),c={x:0,y:0};if(a instanceof Element){var u=a.getBoundingClientRect();c={x:"r"===this.hdir?u.left+u.width:u.left-l.width,y:u.top},a.className.includes("submenu")&&(c.y+="d"===this.vdir?4:-12);var h=this.getPosition(l,c);c.x!==h.x&&(this.hdir="r"===this.hdir?"l":"r",c.x="r"===this.hdir?u.left+u.width:u.left-l.width),c.y!==h.y&&(this.vdir="u"===this.vdir?"d":"u",c.y=h.y),c=this.getPosition(l,c,!1)}else c=this.getPosition(l,{x:a.clientX,y:a.clientY});return s.style.left=c.x+"px",s.style.top=c.y+"px",s.addEventListener("contextmenu",(function(e){e.stopPropagation(),e.preventDefault()})),s.addEventListener("click",(function(e){var t=e.target instanceof Element&&e.target.parentElement;t&&"interactive"!==t.className&&e.stopPropagation()})),s},r.prototype.openSubMenu=function(e,t,n){var i,o=null===(i=n.parentElement)||void 0===i?void 0:i.querySelector("li > ul");o&&o.parentElement!==n&&this.hide(o),n.appendChild(this.generateDOM(t,n))},r.getBounding=function(e){var t=e.cloneNode(!0);t.style.visibility="hidden",document.body.appendChild(t);var n=t.getBoundingClientRect();return document.body.removeChild(t),n},r.prototype.getPosition=function(e,t,n){void 0===n&&(n=!0);var i=window.innerWidth,o=window.innerHeight,r=""!==document.body.style.transform,a=r?window.scrollX:0,d=r?window.scrollY:0,s=r?i+window.scrollX:i,l=r?o+window.scrollY:o;return r&&n&&(t.x+=window.scrollX,t.y+=window.scrollY),{x:"r"===this.hdir?t.x+e.width>s?s-e.width:t.x:t.x<a?a:t.x,y:"d"===this.vdir?t.y+e.height>l?l-e.height:t.y:t.y<d?d:t.y}},r.addStylesToDom=function(){var e=function(){if("loading"===document.readyState)return document.addEventListener("readystatechange",e);var t=document.createElement("style");t.innerHTML='.ctxmenu{position:fixed;max-height:100vh;border:1px solid #999;padding:2px 0;box-shadow:#aaa 3px 3px 3px;background:#fff;margin:0;z-index:9999;overflow-y:auto;font:15px Verdana, sans-serif}.ctxmenu li{margin:1px 0;display:block;position:relative;user-select:none}.ctxmenu li span{display:block;padding:2px 20px;cursor:default}.ctxmenu li a{color:inherit;text-decoration:none}.ctxmenu li.icon{padding-left:15px}.ctxmenu img.icon{position:absolute;width:18px;left:10px;top:2px}.ctxmenu li.disabled{color:#ccc}.ctxmenu li.divider{border-bottom:1px solid #aaa;margin:5px 0}.ctxmenu li.interactive:hover{background:rgba(0, 0, 0, 0.1)}.ctxmenu li.submenu::after{content:"";position:absolute;display:block;top:0;bottom:0;right:.4em;margin:auto .1rem auto auto;border-right:1px solid #000;border-top:1px solid #000;transform:rotate(45deg);width:.3rem;height:.3rem}.ctxmenu li.submenu.disabled::after{border-color:#ccc}',document.head.insertBefore(t,document.head.childNodes[0]),e=function(){}};e()},r}().getInstance();exports.ctxmenu=r;
